#!/bin/bash
# MODEL_TYPE=circulant_2_layers_mask_2_no_bias
# LOSS_TYPE=cross_entropy
# DATASET=fashion_mnist
# NUM_SAMPLES=15000
# NUM_ITERATIONS=100000
# python3.7 ./code/distributed_optimization_library/experiments/local_optimization_pytorch/config_nn.py --dumps_path /home/tyurina/local_experiments --experiments_name adaptive_stable_gd_two_layer_eos_${MODEL_TYPE}_dataset_${DATASET}_loss_${LOSS_TYPE}_num_samples_${NUM_SAMPLES}_more_iters_filter_classes_0_1 --step_sizes 1.0 --dataset_path /home/tyurina/data --optimizer adaptive_stable_gd --batch_size 5000 --model two_layer_nn_eos --save_every 100 --number_of_iterations ${NUM_ITERATIONS} --num_workers 4 --resnet_activation elu --save_model_every 1000 --use_cuda --eos_type $MODEL_TYPE --local_run --loss_function $LOSS_TYPE --number_of_samples ${NUM_SAMPLES} --filter_classes 0 1 --dataset ${DATASET}
# python3.7 ./code/distributed_optimization_library/experiments/local_optimization_pytorch/config_nn.py --dumps_path /home/tyurina/local_experiments --experiments_name gd_two_layer_eos_${MODEL_TYPE}_dataset_${DATASET}_loss_${LOSS_TYPE}_num_samples_${NUM_SAMPLES}_more_iters_filter_classes_0_1 --step_sizes 0.25 0.1 0.05 0.025 0.01 0.005 --dataset_path /home/tyurina/data --optimizer gd --batch_size 5000 --model two_layer_nn_eos --save_every 100 --number_of_iterations ${NUM_ITERATIONS} --num_workers 4 --resnet_activation elu --save_model_every 1000 --use_cuda --eos_type $MODEL_TYPE --local_run --devices 1 2 3 --loss_function $LOSS_TYPE --number_of_samples ${NUM_SAMPLES} --filter_classes 0 1 --dataset ${DATASET}

# python3.7 ./code/distributed_optimization_library/experiments/local_optimization_pytorch/config_nn.py --dumps_path /home/tyurina/local_experiments --experiments_name adaptive_stable_gd_two_layer_eos_${MODEL_TYPE}_dataset_${DATASET}_loss_${LOSS_TYPE}_num_samples_${NUM_SAMPLES}_more_iters_more_iters --step_sizes 1.0 --dataset_path /home/tyurina/data --optimizer adaptive_stable_gd --batch_size 5000 --model two_layer_nn_eos --save_every 100 --number_of_iterations ${NUM_ITERATIONS} --num_workers 4 --resnet_activation elu --save_model_every 1000 --use_cuda --eos_type $MODEL_TYPE --local_run --loss_function $LOSS_TYPE --number_of_samples ${NUM_SAMPLES} --dataset ${DATASET}
# python3.7 ./code/distributed_optimization_library/experiments/local_optimization_pytorch/config_nn.py --dumps_path /home/tyurina/local_experiments --experiments_name gd_two_layer_eos_${MODEL_TYPE}_dataset_${DATASET}_loss_${LOSS_TYPE}_num_samples_${NUM_SAMPLES}_more_iters_more_iters --step_sizes 0.5 0.25 0.1 0.05 0.025 0.01 0.005 --dataset_path /home/tyurina/data --optimizer gd --batch_size 5000 --model two_layer_nn_eos --save_every 100 --number_of_iterations ${NUM_ITERATIONS} --num_workers 4 --resnet_activation elu --save_model_every 1000 --use_cuda --eos_type $MODEL_TYPE --local_run --devices 1 2 3 --loss_function $LOSS_TYPE --number_of_samples ${NUM_SAMPLES} --dataset ${DATASET}


MODEL_TYPE=linear_0

python3.7 ./code/distributed_optimization_library/experiments/local_optimization_pytorch/config_nn.py --dumps_path /home/tyurina/local_experiments --experiments_name iac_gd_two_layer_nn_paper_${MODEL_TYPE} --step_sizes 10.0 5.0 1.0 0.5 0.1 0.05 0.01 --dataset_path /home/tyurina/data --optimizer gd --model two_layer_nn_paper --save_every 100 --number_of_iterations 100000 --num_workers 4 --save_model_every 1000 --use_cuda --eos_type $MODEL_TYPE --filter_classes 0 1 --loss_function bce_logits --devices 1 2 3 --not_optimize_memory
python3.7 ./code/distributed_optimization_library/experiments/local_optimization_pytorch/config_nn.py --dumps_path /home/tyurina/local_experiments --experiments_name iac_adaptive_stable_gd_two_layer_nn_paper_${MODEL_TYPE} --step_sizes 10. --dataset_path /home/tyurina/data --optimizer adaptive_stable_gd --model two_layer_nn_paper --save_every 100 --number_of_iterations 100000 --num_workers 4 --save_model_every 1000 --use_cuda --eos_type $MODEL_TYPE --filter_classes 0 1 --loss_function bce_logits --devices 1 2 3 --not_optimize_memory

# python3.7 ./code/distributed_optimization_library/experiments/local_optimization_pytorch/config_nn.py --dumps_path /home/tyurina/local_experiments --experiments_name gd_two_layer_eos_${MODEL_TYPE}_dataset_${DATASET}_loss_${LOSS_TYPE}_num_samples_${NUM_SAMPLES}_more_iters_more_steps --step_sizes 0.5 1.0 2.0 5.0 --dataset_path /home/tyurina/data --optimizer gd --batch_size 5000 --model two_layer_nn_eos --save_every 100 --number_of_iterations ${NUM_ITERATIONS} --num_workers 4 --resnet_activation elu --save_model_every 1000 --use_cuda --eos_type $MODEL_TYPE --local_run --devices 1 2 3 --loss_function $LOSS_TYPE --number_of_samples ${NUM_SAMPLES} --dataset ${DATASET}